# FRAGSYS
This repository contains the fragment screeening analysis pipeline (**FRAGSYS**) used for the analysis of our manuscript _Classification of likely functional state for ligand binding sites identified from fragment screening_ submitted to the journal [Nature Communications](https://www.nature.com/ncomms/), which can be found in their preprint server here: *INSERT_PAPER_REF*. 

On this main folder, we can find 5 directories, and 5 files.

FRAGSYS, i.e., our pipeline for the analysis of binding sites, can be executed from the jupyter notebook [`running_fragsys.ipynb`](running_fragsys.ipynb). The input for this pipeline is a list of protein [UniProt](https://www.uniprot.org/) accession identifiers.


## Files
There are 5 different files on this repository main directory. Three of these are python libraries, then a notebook, and a configuration file.
  +  [`fragsys_config.txt`](fragsys_config.txt) contains the default parameters to run **FRAGSYS** and it is read by [`fragsys.py`](fragsys.py).
  +  [`fragsys.py`](fragsys.py) contains all the function, lists and dictionaries needed to run the pipeline.
  +  [`fragsys_main.py`](fragsys_main.py) contains the main **FRAGSYS** function, where all functions in [`fragsys.py`](fragsys.py) are called. This script represents the pipeline itself.
  +  [`running_fragsys.ipynb`](running_fragsys.ipynb) is the notebook where the pipeline is executed in an interactive way.
## Directories
### [`envs`](envs/)
The envs folder contains three .yml files describing the necessary packages and dependencies for the different parts of the pipeline and analysis.
  +  [varalign_env](envs/varalign_env.yml) is needed to run FRAGSYS.
  +  [myenv2](envs/myenv2.yml) supports all analysis notebooks, with the exception of number [11](analysis/11_fragsys_ML_create_models.ipynb), [12](analysis/12_fragsys_ML_test_models.ipynb), in which the machine learning models are executed.
  +  [deep_learning](envs/deep_learning.yml) contains the packages necessary to do the machine learning in notebooks [11](analysis/11_fragsys_ML_create_models.ipynb), and [12](analysis/12_fragsys_ML_test_models.ipynb).
### [`input`](input/)
The input folder contains the main input file which is used as input to run **FRAGSYS** on the [running_fragsys notebook](running_fragsys.ipynb).
### [`analysis`](analysis/)
The analysis folder contains all the notebooks used to carry out the analysis of the 35 fragment screening experiments. myenv2 is needed to run these notebooks.
### [`results`](results/)
The results folder contains all the results files generated by the notebooks in the analysis folder.
### [`figs`](figs/)
The figs folder contains the main figures generated and saved by the analysis notebooks.
